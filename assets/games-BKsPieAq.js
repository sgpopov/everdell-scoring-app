import{e as H,q as _,s as k,v as U,x as $,r as M,y as q,z as K,A as Q,B as X,C as Y,b as z,D as S,u as Z,E as ee}from"./index-hIdiJzXK.js";function te(e){return Q()?(X(e),!0):!1}const ne=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const re=Object.prototype.toString,oe=e=>re.call(e)==="[object Object]",ie=()=>{};function ae(e,t){function n(...r){return new Promise((a,c)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(a).catch(c)})}return n}const J=e=>e();function ue(e=J,t={}){const{initialState:n="active"}=t,r=le(n==="active");function a(){r.value=!1}function c(){r.value=!0}const m=(...i)=>{r.value&&e(...i)};return{isActive:k(r),pause:a,resume:c,eventFilter:m}}function se(e){return K()}function C(e){return Array.isArray(e)?e:[e]}function le(...e){if(e.length!==1)return $(...e);const t=e[0];return typeof t=="function"?k(q(()=>({get:t,set:ie}))):M(t)}function ce(e,t,n={}){const{eventFilter:r=J,...a}=n;return U(e,ae(r,t),a)}function de(e,t,n={}){const{eventFilter:r,initialState:a="active",...c}=n,{eventFilter:m,pause:i,resume:u,isActive:s}=ue(r,{initialState:a});return{stop:ce(e,t,{...c,eventFilter:m}),pause:i,resume:u,isActive:s}}function fe(e,t=!0,n){se()?H(e,n):t?e():_(e)}function pe(e,t,n){return U(e,t,{...n,immediate:!0})}const N=ne?window:void 0;function me(e){var t;const n=S(e);return(t=n==null?void 0:n.$el)!=null?t:n}function T(...e){const t=[],n=()=>{t.forEach(i=>i()),t.length=0},r=(i,u,s,f)=>(i.addEventListener(u,s,f),()=>i.removeEventListener(u,s,f)),a=z(()=>{const i=C(S(e[0])).filter(u=>u!=null);return i.every(u=>typeof u!="string")?i:void 0}),c=pe(()=>{var i,u;return[(u=(i=a.value)==null?void 0:i.map(s=>me(s)))!=null?u:[N].filter(s=>s!=null),C(S(a.value?e[1]:e[0])),C(Z(a.value?e[2]:e[1])),S(a.value?e[3]:e[2])]},([i,u,s,f])=>{if(n(),!(i!=null&&i.length)||!(u!=null&&u.length)||!(s!=null&&s.length))return;const g=oe(f)?{...f}:f;t.push(...i.flatMap(j=>u.flatMap(b=>s.map(O=>r(j,b,O,g)))))},{flush:"post"}),m=()=>{c(),n()};return te(n),m}const E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D="__vueuse_ssr_handlers__",ye=ge();function ge(){return D in E||(E[D]=E[D]||{}),E[D]}function ve(e,t){return ye[e]||t}function he(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Se={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},V="vueuse-storage";function be(e,t,n,r={}){var a;const{flush:c="pre",deep:m=!0,listenToStorageChanges:i=!0,writeDefaults:u=!0,mergeDefaults:s=!1,shallow:f,window:g=N,eventFilter:j,onError:b=o=>{console.error(o)},initOnMounted:O}=r,v=(f?Y:M)(typeof t=="function"?t():t),y=z(()=>S(e));if(!n)try{n=ve("getDefaultStorage",()=>{var o;return(o=N)==null?void 0:o.localStorage})()}catch(o){b(o)}if(!n)return v;const h=S(t),I=he(h),w=(a=r.serializer)!=null?a:Se[I],{pause:L,resume:R}=de(v,()=>P(v.value),{flush:c,deep:m,eventFilter:j});U(y,()=>A(),{flush:c}),g&&i&&fe(()=>{n instanceof Storage?T(g,"storage",A,{passive:!0}):T(g,V,B),O&&A()}),O||A();function x(o,d){if(g){const p={key:y.value,oldValue:o,newValue:d,storageArea:n};g.dispatchEvent(n instanceof Storage?new StorageEvent("storage",p):new CustomEvent(V,{detail:p}))}}function P(o){try{const d=n.getItem(y.value);if(o==null)x(d,null),n.removeItem(y.value);else{const p=w.write(o);d!==p&&(n.setItem(y.value,p),x(d,p))}}catch(d){b(d)}}function G(o){const d=o?o.newValue:n.getItem(y.value);if(d==null)return u&&h!=null&&n.setItem(y.value,w.write(h)),h;if(!o&&s){const p=w.read(d);return typeof s=="function"?s(p,h):I==="object"&&!Array.isArray(p)?{...h,...p}:p}else return typeof d!="string"?d:w.read(d)}function A(o){if(!(o&&o.storageArea!==n)){if(o&&o.key==null){v.value=h;return}if(!(o&&o.key!==y.value)){L();try{(o==null?void 0:o.newValue)!==w.write(v.value)&&(v.value=G(o))}catch(d){b(d)}finally{o?_(R):R()}}}}function B(o){A(o.detail)}return v}function we(e,t,n={}){const{window:r=N}=n;return be(e,t,r==null?void 0:r.localStorage,n)}const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function Ae(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}let F;const Oe=new Uint8Array(16);function Ee(){if(!F){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");F=crypto.getRandomValues.bind(crypto)}return F(Oe)}const De=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),W={randomUUID:De};function Ne(e,t,n){var a;if(W.randomUUID&&!e)return W.randomUUID();e=e||{};const r=e.random??((a=e.rng)==null?void 0:a.call(e))??Ee();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ae(r)}const Ce=ee("games",{state:()=>({games:we("games",[])}),getters:{getAll:e=>e.games,getById:e=>t=>e.games.find(n=>n.id===t)},actions:{createGame(e){const t=e.map(r=>({...r,scores:{base_cards:0,base_prosperity:0,base_events:0,base_journey:0,base_tokens:0},total:0})),n={id:Ne(),startedAt:new Date().toISOString(),players:t};return this.games.push(n),n},updateGameScores(e,t,n){const r=this.getById(e);if(!r)return;const a=r.players.map(c=>{const m=n.find(s=>s.id===c.id);if(!m)return c;const i=m.score,u={...c.scores,[t]:Number(i)};return{...c,scores:u,total:Object.values(u).reduce((s,f)=>s+f,0)}});return r.players=a,r}}});export{Ce as u};
